<!DOCTYPE html>
<html>
<head>
    <title>Test de Reserva</title>
</head>
<body>
    <h1>Test de Envío de Reserva</h1>
    <button onclick="testReservaConFormulario()">Enviar Reserva con Formulario</button>
    <button onclick="testReservaConIframe()">Enviar Reserva con Iframe</button>
    <div id="resultado"></div>

    <script>
        // URL del script de Google Apps Script
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbysoBEGQiTf3Gpv886Nw_UBPVGvK0-j_bug3CGuf5J8PZHdMKmtziU6wGJjBi9lIAz1Mw/exec';
        
        function testReservaConFormulario() {
            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.innerHTML = 'Enviando reserva con formulario...';
            
            // Datos de prueba
            const datosPrueba = {
                codigo_reserva: "TEST-FORM-456",
                name: "test-form@example.com",
                email_cliente: "test-form@example.com",
                fecha: "28 de noviembre de 2025",
                hora: "21:00",
                origen: "Test Origen Formulario",
                destino: "Test Destino Formulario",
                pasajeros: "4",
                telefono: "1122334455",
                equipaje: "Sí",
                maletas: "5",
                origen_completo: "Dirección completa de origen formulario",
                destino_completo: "Dirección completa de destino formulario"
            };
            
            try {
                console.log('Enviando datos de prueba con formulario:', datosPrueba);
                
                // Crear un formulario dinámico
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = SCRIPT_URL;
                form.target = '_blank'; // Abrir en nueva pestaña
                form.style.display = 'none';
                
                // Añadir los datos como campos ocultos
                for (const key in datosPrueba) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = datosPrueba[key];
                    form.appendChild(input);
                }
                
                // Añadir un botón de submit
                const submitButton = document.createElement('input');
                submitButton.type = 'submit';
                submitButton.value = 'Enviar';
                form.appendChild(submitButton);
                
                // Añadir el formulario al documento
                document.body.appendChild(form);
                
                // Mostrar mensaje de éxito
                resultadoDiv.innerHTML = `
                    <h2>Formulario creado</h2>
                    <p>El formulario se ha creado y se enviará automáticamente.</p>
                    <p>Verifica tu hoja de cálculo de Google Sheets.</p>
                `;
                
                // Enviar el formulario después de un corto retraso
                setTimeout(() => {
                    form.submit();
                }, 1000);
                
            } catch (error) {
                console.error('Error al enviar con formulario:', error);
                resultadoDiv.innerHTML = `
                    <h2>Error con Formulario</h2>
                    <p>${error.message}</p>
                `;
            }
        }
        
        function testReservaConIframe() {
            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.innerHTML = 'Enviando reserva con iframe...';
            
            // Datos de prueba
            const datosPrueba = {
                codigo_reserva: "TEST-IFRAME-789",
                name: "test-iframe@example.com",
                email_cliente: "test-iframe@example.com",
                fecha: "28 de noviembre de 2025",
                hora: "22:00",
                origen: "Test Origen Iframe",
                destino: "Test Destino Iframe",
                pasajeros: "2",
                telefono: "5566778899",
                equipaje: "Sí",
                maletas: "1",
                origen_completo: "Dirección completa de origen iframe",
                destino_completo: "Dirección completa de destino iframe"
            };
            
            try {
                console.log('Enviando datos de prueba con iframe:', datosPrueba);
                
                // Crear un iframe oculto
                const iframe = document.createElement('iframe');
                iframe.name = 'formularioIframe';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                // Crear un formulario dinámico que apunte al iframe
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = SCRIPT_URL;
                form.target = 'formularioIframe';
                form.style.display = 'none';
                
                // Añadir los datos como campos ocultos
                for (const key in datosPrueba) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = datosPrueba[key];
                    form.appendChild(input);
                }
                
                // Añadir el formulario al documento
                document.body.appendChild(form);
                
                // Mostrar mensaje de éxito
                resultadoDiv.innerHTML = `
                    <h2>Iframe creado</h2>
                    <p>El formulario se ha enviado a través de un iframe.</p>
                    <p>Verifica tu hoja de cálculo de Google Sheets.</p>
                `;
                
                // Enviar el formulario
                form.submit();
                
                // Limpiar después de un tiempo
                setTimeout(() => {
                    document.body.removeChild(form);
                    document.body.removeChild(iframe);
                }, 5000);
                
            } catch (error) {
                console.error('Error al enviar con iframe:', error);
                resultadoDiv.innerHTML = `
                    <h2>Error con Iframe</h2>
                    <p>${error.message}</p>
                `;
            }
        }
    </script>
</body>
</html>